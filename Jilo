import json
import random

# --- –ò–º–∏—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –æ—Ç API (–≤ –≤–∏–¥–µ JSON-—Å—Ç—Ä–æ–∫–∏) ---
RANDOM_API_DATA = """
[
    {
        "id": 101,
        "username": "AlphaDev",
        "email": "alpha@example.com",
        "is_active": true,
        "role": "admin",
        "last_login_days": 5
    },
    {
        "id": 102,
        "username": "BetaUser",
        "email": "beta@example.com",
        "is_active": false,
        "role": "user",
        "last_login_days": 45
    },
    {
        "id": 103,
        "username": "GammaTest",
        "email": "gamma@example.com",
        "is_active": true,
        "role": "moderator",
        "last_login_days": 1
    },
    {
        "id": 104,
        "username": "Delta",
        "email": "delta@example.com",
        "is_active": false,
        "role": "user",
        "last_login_days": 180
    }
]
"""
# --- –ö–æ–Ω–µ—Ü –∏–º–∏—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö ---

def load_and_parse_data(json_string):
    """–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç JSON-—Å—Ç—Ä–æ–∫—É –≤ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π Python."""
    try:
        data = json.loads(json_string)
        print(f"‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ù–∞–π–¥–µ–Ω–æ {len(data)} –∑–∞–ø–∏—Å–µ–π.")
        return data
    except json.JSONDecodeError as e:
        print(f"‚ùå –û–®–ò–ë–ö–ê: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON. {e}")
        return []

def filter_active_admins(user_data):
    """
    –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, 
    –∫—Ç–æ –∞–∫—Ç–∏–≤–µ–Ω –ò –∏–º–µ–µ—Ç —Ä–æ–ª—å 'admin'.
    """
    filtered_list = []
    
    for user in user_data:
        # –£—Å–ª–æ–≤–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
        if user.get("is_active") is True and user.get("role") == "admin":
            filtered_list.append(user)
            
    return filtered_list

def filter_inactive_long_time(user_data, threshold_days=30):
    """
    –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã –ò –Ω–µ –ª–æ–≥–∏–Ω–∏–ª–∏—Å—å –¥–æ–ª—å—à–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞.
    """
    inactive_list = []
    
    for user in user_data:
        # –£—Å–ª–æ–≤–∏–µ: –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω –ò log-in > –ø–æ—Ä–æ–≥–∞
        if user.get("is_active") is False and user.get("last_login_days", 0) > threshold_days:
            inactive_list.append(user)
            
    return inactive_list


# --- –ì–ª–∞–≤–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã ---

print("--- ‚öôÔ∏è –û–ë–†–ê–ë–û–¢–ö–ê –ò –§–ò–õ–¨–¢–†–ê–¶–ò–Ø JSON-–î–ê–ù–ù–´–• ---")

# 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
users = load_and_parse_data(RANDOM_API_DATA)

if not users:
    exit()

# 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
admins = filter_active_admins(users)
print("\n--- üìù –û—Ç—á–µ—Ç 1: –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã ---")
if admins:
    for user in admins:
        print(f"–ò–º—è: {user['username']}, Email: {user['email']}")
else:
    print("–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.")

# 3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è "—Å–ø—è—â–∏—Ö" –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–ª—å—à–µ 30 –¥–Ω–µ–π)
INACTIVITY_THRESHOLD = 30
inactive_users = filter_inactive_long_time(users, INACTIVITY_THRESHOLD)

print(f"\n--- üò¥ –û—Ç—á–µ—Ç 2: –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ª–æ–≥–∏–Ω > {INACTIVITY_THRESHOLD} –¥–Ω–µ–π) ---")
if inactive_users:
    for user in inactive_users:
        print(f"–ò–º—è: {user['username']}, –†–æ–ª—å: {user['role']}, –î–Ω–µ–π –±–µ–∑ –≤—Ö–æ–¥–∞: {user['last_login_days']}")
else:
    print("–°–ø—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.")
